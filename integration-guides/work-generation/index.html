



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Understand the best configurations for work generation on the Nano network.">
      
      
        <link rel="canonical" href="https://docs.nano.org/integration-guides/work-generation/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.2.0">
    
    
      
        <title>Work Generation | Nano Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.750b69bd.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Noto Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../stylesheets/extras.css">
    
    

<!-- Matomo -->
<script type="text/javascript">
  var _paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://nano.matomo.cloud/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '3']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src='//cdn.matomo.cloud/nano.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->


    
  <!-- Twitter Card data -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@nano">
  <meta name="twitter:title" content="Work Generation | Nano Documentation">
  <meta name="twitter:description" content="Understand the best configurations for work generation on the Nano network.">
  <meta name="twitter:image" content="https://docs.nano.org/images/nano-docs-open-graph.png" />

  <!-- Open Graph data -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Work Generation | Nano Documentation" />
  <meta property="og:url" content="https://docs.nano.org/integration-guides/work-generation/" />
  <meta property="og:image" content="https://docs.nano.org/images/nano-docs-open-graph.png" />
  <meta property="og:description" content="Understand the best configurations for work generation on the Nano network." />
  <meta property="og:site_name" content="Nano Docs" />


  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="#4a90e2" data-md-color-accent="#131121">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#system-considerations" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://docs.nano.org/" title="Documentation" class="md-header-nav__button md-logo">
          
            <img src="../../images/nano.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Documentation
            </span>
            <span class="md-header-nav__topic">
              Work Generation
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/nanocurrency/nano-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    nanocurrency/nano-docs
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://docs.nano.org/" title="Documentation" class="md-nav__button md-logo">
      
        <img src="../../images/nano.svg" width="48" height="48">
      
    </a>
    Documentation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/nanocurrency/nano-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    nanocurrency/nano-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      What is Nano?
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        What is Nano?
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../what-is-nano/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../what-is-nano/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../what-is-nano/exploring-more/" title="Exploring More" class="md-nav__link">
      Exploring More
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Running a Node
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Running a Node
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../running-a-node/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../running-a-node/security/" title="Security" class="md-nav__link">
      Security
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../running-a-node/node-setup/" title="Node Setup" class="md-nav__link">
      Node Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../running-a-node/docker-management/" title="Docker Management" class="md-nav__link">
      Docker Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../running-a-node/configuration/" title="Configuration" class="md-nav__link">
      Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../running-a-node/ledger-management/" title="Ledger Management" class="md-nav__link">
      Ledger Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../running-a-node/voting-as-a-representative/" title="Voting as a Representative" class="md-nav__link">
      Voting as a Representative
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../running-a-node/beta-network/" title="Beta Network" class="md-nav__link">
      Beta Network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../running-a-node/troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../running-a-node/beyond-the-node/" title="Beyond the Node" class="md-nav__link">
      Beyond the Node
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Integration Guides
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Integration Guides
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../the-basics/" title="The Basics" class="md-nav__link">
      The Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../key-management/" title="Key Management" class="md-nav__link">
      Key Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../block-confirmation-tracking/" title="Block Confirmation Tracking" class="md-nav__link">
      Block Confirmation Tracking
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Work Generation
      </label>
    
    <a href="./" title="Work Generation" class="md-nav__link md-nav__link--active">
      Work Generation
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#system-considerations" title="System considerations" class="md-nav__link">
    System considerations
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cpu-vs-gpu" title="CPU vs. GPU" class="md-nav__link">
    CPU vs. GPU
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#choosing-a-machine" title="Choosing a machine" class="md-nav__link">
    Choosing a machine
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#software-for-work-generation" title="Software for work generation" class="md-nav__link">
    Software for work generation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#number-of-work-peers" title="Number of work peers" class="md-nav__link">
    Number of work peers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommended-configurations" title="Recommended configurations" class="md-nav__link">
    Recommended configurations
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#heavy-rpc-regular-work-generation" title="Heavy RPC, regular work generation" class="md-nav__link">
    Heavy RPC, regular work generation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#light-rpc-regular-work-generation" title="Light RPC, regular work generation" class="md-nav__link">
    Light RPC, regular work generation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practical-guides" title="Practical guides" class="md-nav__link">
    Practical guides
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#work-generated-using-the-node-incl-work-peers" title="Work generated using the node, incl. work peers" class="md-nav__link">
    Work generated using the node, incl. work peers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#work-generated-without-using-the-node" title="Work generated without using the node" class="md-nav__link">
    Work generated without using the node
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#node-configuration" title="Node Configuration" class="md-nav__link">
    Node Configuration
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openclenable" title="opencl.enable" class="md-nav__link">
    opencl.enable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodework_threads" title="node.work_threads" class="md-nav__link">
    node.work_threads
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodework_peers" title="node.work_peers" class="md-nav__link">
    node.work_peers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodemax_work_generate_multiplier" title="node.max_work_generate_multiplier" class="md-nav__link">
    node.max_work_generate_multiplier
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#benchmarks" title="Benchmarks" class="md-nav__link">
    Benchmarks
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#benchmark-commands" title="Benchmark commands" class="md-nav__link">
    Benchmark commands
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-benchmarks" title="Example benchmarks" class="md-nav__link">
    Example benchmarks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#work-calculation-details" title="Work calculation details" class="md-nav__link">
    Work calculation details
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#work-equation" title="Work equation" class="md-nav__link">
    Work equation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#difficulty-thresholds" title="Difficulty thresholds" class="md-nav__link">
    Difficulty thresholds
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-caching" title="Pre-caching" class="md-nav__link">
    Pre-caching
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#difficulty-multiplier" title="Difficulty multiplier" class="md-nav__link">
    Difficulty multiplier
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../build-options/" title="Build Options" class="md-nav__link">
      Build Options
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../websockets/" title="WebSockets" class="md-nav__link">
      WebSockets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ipc-integration/" title="IPC Integration" class="md-nav__link">
      IPC Integration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../advanced/" title="Advanced" class="md-nav__link">
      Advanced
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Commands
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Commands
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../commands/rpc-protocol/" title="RPC Protocol" class="md-nav__link">
      RPC Protocol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../commands/command-line-interface/" title="Command Line Interface" class="md-nav__link">
      Command Line Interface
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Protocol Design
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Protocol Design
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../protocol-design/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../protocol-design/distribution-and-units/" title="Distribution and Units" class="md-nav__link">
      Distribution and Units
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../protocol-design/networking/" title="Networking" class="md-nav__link">
      Networking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../protocol-design/network-attacks/" title="Network Attacks" class="md-nav__link">
      Network Attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../protocol-design/signing-hashing-and-key-derivation/" title="Signing, Hashing and Key Derivation" class="md-nav__link">
      Signing, Hashing and Key Derivation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../whitepaper/english/" title="Original whitepaper" class="md-nav__link">
      Original whitepaper
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Releases
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Releases
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../releases/node-releases/" title="Node Releases" class="md-nav__link">
      Node Releases
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../releases/current-release-notes/" title="Current Release Notes" class="md-nav__link">
      Current Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../releases/previous-release-notes/" title="Previous Release Notes" class="md-nav__link">
      Previous Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../releases/network-upgrades/" title="Network Upgrades" class="md-nav__link">
      Network Upgrades
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../releases/upcoming-features/" title="Upcoming Features" class="md-nav__link">
      Upcoming Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../releases/roadmap/" title="Roadmap" class="md-nav__link">
      Roadmap
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../glossary/" title="Glossary" class="md-nav__link">
      Glossary
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#system-considerations" title="System considerations" class="md-nav__link">
    System considerations
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cpu-vs-gpu" title="CPU vs. GPU" class="md-nav__link">
    CPU vs. GPU
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#choosing-a-machine" title="Choosing a machine" class="md-nav__link">
    Choosing a machine
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#software-for-work-generation" title="Software for work generation" class="md-nav__link">
    Software for work generation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#number-of-work-peers" title="Number of work peers" class="md-nav__link">
    Number of work peers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommended-configurations" title="Recommended configurations" class="md-nav__link">
    Recommended configurations
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#heavy-rpc-regular-work-generation" title="Heavy RPC, regular work generation" class="md-nav__link">
    Heavy RPC, regular work generation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#light-rpc-regular-work-generation" title="Light RPC, regular work generation" class="md-nav__link">
    Light RPC, regular work generation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practical-guides" title="Practical guides" class="md-nav__link">
    Practical guides
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#work-generated-using-the-node-incl-work-peers" title="Work generated using the node, incl. work peers" class="md-nav__link">
    Work generated using the node, incl. work peers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#work-generated-without-using-the-node" title="Work generated without using the node" class="md-nav__link">
    Work generated without using the node
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#node-configuration" title="Node Configuration" class="md-nav__link">
    Node Configuration
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openclenable" title="opencl.enable" class="md-nav__link">
    opencl.enable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodework_threads" title="node.work_threads" class="md-nav__link">
    node.work_threads
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodework_peers" title="node.work_peers" class="md-nav__link">
    node.work_peers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodemax_work_generate_multiplier" title="node.max_work_generate_multiplier" class="md-nav__link">
    node.max_work_generate_multiplier
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#benchmarks" title="Benchmarks" class="md-nav__link">
    Benchmarks
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#benchmark-commands" title="Benchmark commands" class="md-nav__link">
    Benchmark commands
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-benchmarks" title="Example benchmarks" class="md-nav__link">
    Example benchmarks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#work-calculation-details" title="Work calculation details" class="md-nav__link">
    Work calculation details
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#work-equation" title="Work equation" class="md-nav__link">
    Work equation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#difficulty-thresholds" title="Difficulty thresholds" class="md-nav__link">
    Difficulty thresholds
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-caching" title="Pre-caching" class="md-nav__link">
    Pre-caching
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#difficulty-multiplier" title="Difficulty multiplier" class="md-nav__link">
    Difficulty multiplier
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/nanocurrency/nano-docs/edit/master/docs/integration-guides/work-generation.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Work Generation</h1>
                
                <div class="admonition tip">
<p class="admonition-title">Some sections of this page target node version 21 or higher</p>
</div>
<p>Every block published to the network, whether a send, receive or representative change block, requires a small, valid <a href="../../glossary/#proof-of-work-pow">Proof-of-Work</a> to be completed above a minimum difficulty floor (threshold). As of V21 this threshold is different for different block types: send and change blocks require a higher threshold, while receive blocks are lower.</p>
<p>This work value is not used in consensus, but instead is one of the first pieces of data used to validate blocks on the network and is a key component of maintaining consistent quality of service on the network.</p>
<h2 id="system-considerations">System considerations<a class="headerlink" href="#system-considerations" title="Permanent link">&para;</a></h2>
<p>The following configuration options should be taken into careful consideration when planning work generation resources for services integrating with Nano. These options should be combined to provide the best separation of resources between node participation on network vs. work generation needs.</p>
<div class="admonition warning">
<p class="admonition-title">Representatives should avoid heavy RPC use and work generation</p>
<p>Supporting the network by running a representative is recommended for many services, however it is not recommended that voting nodes are used for heavy RPC or work generation activities. Wherever possible, integrations should utilize separate machines for their integration nodes and consensus-producing, voting nodes.</p>
</div>
<h3 id="cpu-vs-gpu">CPU vs. GPU<a class="headerlink" href="#cpu-vs-gpu" title="Permanent link">&para;</a></h3>
<p>As GPUs provide faster and more energy efficient work generation than CPUs, and reduce RPC delays during heavy usage periods, they are preferred for any setups able to utilize them. In cases where the node is running on the same machine where work generation is done, GPUs are highly recommended to avoid performance impacts to the node that relying CPU cores can cause.</p>
<h3 id="choosing-a-machine">Choosing a machine<a class="headerlink" href="#choosing-a-machine" title="Permanent link">&para;</a></h3>
<p>Using a separate machine to manage work generation is recommended where possible. The machine running the node should have a minimum of dedicated resources to keep in sync with the network and any potential interruption due to work generation activities should be avoided. Note that this separation introduces latency, so efforts should be done to keep that to a minimum including running machines in the same region or cluster, avoiding routing work requests through external edge networks, etc.</p>
<h3 id="software-for-work-generation">Software for work generation<a class="headerlink" href="#software-for-work-generation" title="Permanent link">&para;</a></h3>
<p>Although the node can be configured to generate work directly, there are plans to separate work generation from the node into its own application and process. To help prepare for this future architecturs the preferred setup today is to use the <a href="https://github.com/nanocurrency/nano-work-server">Nano Work Server</a> for work generation.</p>
<h3 id="number-of-work-peers">Number of work peers<a class="headerlink" href="#number-of-work-peers" title="Permanent link">&para;</a></h3>
<p>To provide a more robust and redundant work generation setup, multiple <a href="#nodework_peers">work peers</a> can be used. Any node configured with multiple peers will make requests serially from the list of work peers until a successful response is received.</p>
<div class="admonition tip">
<p class="admonition-title">Disable local CPU work generation</p>
<p>Since using the same CPU resources the node relies on for work generation can cause performance issues, local CPU work generation should be turned off by setting <a href="#nodework_threads"><code>node.work_threads</code></a> = <code>0</code> when using work peers.</p>
</div>
<h2 id="recommended-configurations">Recommended configurations<a class="headerlink" href="#recommended-configurations" title="Permanent link">&para;</a></h2>
<p>Below are common, recommended configurations for planning work generation needs. Based on the considerations outlined above, the following general rules apply when planning resources:</p>
<ul>
<li>GPU-based work generation is recommended wherever reasonable</li>
<li>Running the <a href="https://github.com/nanocurrency/nano-work-server">Nano Work Server</a> is preferred, regardless of machine or CPU/GPU decisions</li>
<li>CPU-based work generation on the same machine the node is running is not recommended</li>
</ul>
<h3 id="heavy-rpc-regular-work-generation">Heavy RPC, regular work generation<a class="headerlink" href="#heavy-rpc-regular-work-generation" title="Permanent link">&para;</a></h3>
<p>Services with heavy RPC calls and work generation can benefit from ensuring dedicated resources exist for each process separately. To maximize performance a separate machine running the <a href="https://github.com/nanocurrency/nano-work-server">Nano Work Server</a> with a GPU attached is recommended:</p>
<ol>
<li>Setup a machine separate from the node with GPU attached</li>
<li>Install the <a href="https://github.com/nanocurrency/nano-work-server/blob/master/README.md#installation">Nano Work Server</a></li>
<li>Setup a service to start and monitor the work server process using the GPU option <code>--gpu &lt;PLATFORM:DEVICE&gt;</code> and run <code>nano-work-server --help</code> for additional options and details</li>
<li>Configure the machine running the node to allow traffic over TCP from the work generation machine's IP address</li>
<li>Add the work machine IP address as a <a href="#nodework_peers">work peer</a> in the node's <code>config-node.toml</code> file</li>
</ol>
<div class="admonition info">
<p class="admonition-title">CPU for lower generation levels</p>
<p>For services with heavier RPC usage but less work generation needs excluding the GPU in the above example and relying on the CPU resources of the separate machine is also an option. This can be done by setting <a href="#nodework_threads"><code>node.work_threads</code></a> to the appropriate thread count for your needs.</p>
<p>Make sure to benchmark the machine performance to plan for any potential spikes, as CPU generation is slower.</p>
</div>
<h3 id="light-rpc-regular-work-generation">Light RPC, regular work generation<a class="headerlink" href="#light-rpc-regular-work-generation" title="Permanent link">&para;</a></h3>
<p>Services where RPC usage is lighter but regular work generation is needed could move work generation to the same machine if a GPU is used:</p>
<ol>
<li>Install the <a href="https://github.com/nanocurrency/nano-work-server/blob/master/README.md#installation">Nano Work Server</a> on the same machine as the node</li>
<li>Setup a service to start and monitor the work server process with options for using the GPU - <code>--gpu &lt;PLATFORM:DEVICE:THREADS&gt;</code> is required, run <code>nano-work-server --help</code> for additional options and details</li>
<li>Configure the node to prevent local CPU work generation by setting <a href="#nodework_threads"><code>node.work_threads</code></a> = <code>0</code></li>
</ol>
<div class="admonition info">
<p class="admonition-title">Node work generation option</p>
<p>A less preferred alternative to setting up, running and monitoring the Nano Work Server is to use the node itself to generate work. This should only be done with an attached GPU by setting up and enabling OpenCL with <a href="#openclenable"><code>opencl.enable</code></a> = <code>true</code> and adusting <code>opencl.device</code> and <code>opencl.platform</code> to match your setup.</p>
</div>
<hr />
<h2 id="practical-guides">Practical guides<a class="headerlink" href="#practical-guides" title="Permanent link">&para;</a></h2>
<h3 id="work-generated-using-the-node-incl-work-peers">Work generated using the node, incl. work peers<a class="headerlink" href="#work-generated-using-the-node-incl-work-peers" title="Permanent link">&para;</a></h3>
<div class="mermaid">graph TD
    A{Block signing&lt;br&gt; location?}
    A --&gt;|in the node| B[&lt;a href='/commands/rpc-protocol/#block_create'&gt;&lt;b&gt;RPC block_create&lt;/b&gt;&lt;/a&gt;&lt;br&gt;no &lt;i&gt;&amp;quotwork&amp;quot&lt;/i&gt;]
    A --&gt;|not in the node| C_1(Create and sign &lt;b&gt;block&lt;/b&gt;)
    B --&gt;block((block))
    C_1 --&gt;|block| C_2[&lt;a href='/commands/rpc-protocol/#work_generate'&gt;&lt;b&gt;RPC work_generate&lt;/b&gt;&lt;/a&gt;&lt;br&gt;&lt;i&gt;&amp;quotblock&amp;quot: &lt;/i&gt;&lt;b&gt;block&lt;/b&gt;]
    C_2 --&gt;|work| C_3(Use &lt;b&gt;work&lt;/b&gt; in &lt;b&gt;block&lt;/b&gt;)
    C_3 --&gt;block
    block --&gt;D[&lt;a href='/commands/rpc-protocol/#process'&gt;&lt;b&gt;RPC process&lt;/b&gt;&lt;/a&gt;&lt;br&gt;&lt;i&gt;&amp;quotwatch_work&amp;quot: &amp;quottrue&amp;quot&lt;/i&gt;]</div>

<h3 id="work-generated-without-using-the-node">Work generated without using the node<a class="headerlink" href="#work-generated-without-using-the-node" title="Permanent link">&para;</a></h3>
<div class="mermaid">graph TD
    M{Access to a node?} --&gt;|yes| N[active_difficulty &lt;a href='/commands/rpc-protocol/#active_difficulty'&gt;&lt;b&gt;RPC&lt;/b&gt;&lt;/a&gt; or &lt;a href='/integration-guides/websockets/#active-difficulty'&gt;&lt;b&gt;WS&lt;/b&gt;&lt;/a&gt;]
    M --&gt; |no| O_1(&lt;a href='/protocol-design/networking/#node-telemetry'&gt;&lt;b&gt;Telemetry&lt;/b&gt;&lt;/a&gt;)
    N --&gt;|network_minimum| P_1(Generate work at&lt;br&gt;&lt;b&gt;network_minimum&lt;/b&gt; difficulty)
    O_1 --&gt;O_2((active&lt;br&gt;difficulty))
    P_1 --&gt;|work| P_2(Use &lt;b&gt;work&lt;/b&gt; in block)
    P_2 --&gt;P_3((block))
    P_3 --&gt;P_4[&lt;a href='/commands/rpc-protocol/#process'&gt;&lt;b&gt;RPC process&lt;/b&gt;&lt;/a&gt;&lt;br&gt;&lt;i&gt;&amp;quotwatch_work&amp;quot: &amp;quotfalse&amp;quot&lt;/i&gt;]
    P_4 --&gt;P_5(&lt;a href='/integration-guides/block-confirmation-tracking/'&gt;Track block confirmation&lt;/a&gt;)
    P_5 --&gt;P_6{Block unconfirmed&lt;br&gt;after 5 seconds?}
    P_6 --&gt;P_7[active_difficulty &lt;a href='/commands/rpc-protocol/#active_difficulty'&gt;&lt;b&gt;RPC&lt;/b&gt;&lt;/a&gt; or &lt;a href='/integration-guides/websockets/#active-difficulty'&gt;&lt;b&gt;WS&lt;/b&gt;&lt;/a&gt;]
    P_7 --&gt;|network_current| P_8{Block difficulty less&lt;br&gt;than &lt;b&gt;network_current&lt;/b&gt; ?}
    P_8 --&gt;|yes| P_9(Generate work at&lt;br&gt;&lt;b&gt;network_current&lt;/b&gt; difficulty)
    P_8 --&gt;|no| P_6
    P_9 --&gt;|updated_work| P_10(Use &lt;b&gt;updated_work&lt;/b&gt; in &lt;b&gt;block&lt;/b&gt;)
    P_10 --&gt;P_4</div>

<hr />
<h2 id="node-configuration">Node Configuration<a class="headerlink" href="#node-configuration" title="Permanent link">&para;</a></h2>
<p>The following configuration options can be changed in <code>node-config.toml</code>. For more information on the location of this file, and general information on the configuration of the node, see the <a href="../../running-a-node/configuration/">Configuration</a> page.</p>
<h3 id="openclenable">opencl.enable<a class="headerlink" href="#openclenable" title="Permanent link">&para;</a></h3>
<div class="admonition success">
<p class="admonition-title">When GPU acceleration is enabled, the CPU is also used by default</p>
<p>Make sure to set <code>node.work_threads</code> to <code>0</code> when using the GPU</p>
</div>
<p>To enable GPU acceleration for work generation, set this option to <code>true</code>. Other fields may need to be changed if you have multiple OpenCL-enabled platforms and devices.</p>
<h3 id="nodework_threads">node.work_threads<a class="headerlink" href="#nodework_threads" title="Permanent link">&para;</a></h3>
<div class="admonition tip">
<p class="admonition-title">Recommended value: <code>node.work_threads = 0</code></p>
</div>
<p>Determines the number of local CPU threads to used for work generation. <strong>While enabled by default, it is <a href="#recommended-configurations">recommended</a> to turn off local CPU work generation.</strong></p>
<p>Set to <code>0</code> to turn off local CPU work generation.</p>
<h3 id="nodework_peers">node.work_peers<a class="headerlink" href="#nodework_peers" title="Permanent link">&para;</a></h3>
<p>Used when offloading work generation to another node or service. Format must be ipv6, preceded by <code>::ffff:</code> if ipv4. Hostnames are supported since v21. Calls are made to the address:port designated using the standard RPC format <a href="../../commands/rpc-protocol/#work_generate">work_generate</a>. Example:</p>
<div class="codehilite"><pre><span></span>[node]
work_peers = [
    &quot;example.work-peer.org:7000&quot;,
    &quot;::ffff:192.168.1.25:7076&quot;
]
</pre></div>

<h3 id="nodemax_work_generate_multiplier">node.max_work_generate_multiplier<a class="headerlink" href="#nodemax_work_generate_multiplier" title="Permanent link">&para;</a></h3>
<p>Sets a limit on the generation difficulty. Multiplier is based off the <a href="#difficulty-thresholds">base difficulty threshold</a>. If the node is setup as a work peer itself, requests for work higher than this limit are ignored. Default value is <code>64</code>.</p>
<hr />
<h2 id="benchmarks">Benchmarks<a class="headerlink" href="#benchmarks" title="Permanent link">&para;</a></h2>
<h3 id="benchmark-commands">Benchmark commands<a class="headerlink" href="#benchmark-commands" title="Permanent link">&para;</a></h3>
<p><strong>Node RPC or external work server</strong></p>
<ol>
<li>Setup one of the following:<ul>
<li>A node with RPC enabled and any desired work peer</li>
<li>A standalone work server</li>
</ul>
</li>
<li>Use the script from <a href="https://github.com/guilhermelawless/blake2b-pow-bench">blake2b-pow-bench</a></li>
</ol>
<p><strong>Node local work generation</strong></p>
<p>Note that these commands do not use the configuration of the node. Prefer using the alternative above for that purpose, such as changing the number of threads for CPU work generation, or using work peers.</p>
<p><a href="../../commands/command-line-interface/#-debug_profile_generate">CPU</a> with all available threads: <code>nano_node --debug_profile_generate [--difficulty fffffff800000000] [--multiplier 1.0]</code></p>
<p><a href="../../commands/command-line-interface/#-debug_opencl">GPU</a> acceleration: <code>nano_node --debug_opencl --platform=0 --device=0 [--difficulty fffffff800000000] [--multiplier 1.0]</code></p>
<p>The command will trigger continual work generation, so let it run until a sufficient sample size of times are generated (at least 100 instances). Compute the average of these times which are the number of microseconds it took to generate each sample.</p>
<h3 id="example-benchmarks">Example benchmarks<a class="headerlink" href="#example-benchmarks" title="Permanent link">&para;</a></h3>
<p>Below are work generation benchmarks from a variety of consumer-grade CPUs and GPUs. All values are presented in <strong># work/second generated</strong>. See the <a href="#difficulty-thresholds">difficulty thresholds section</a> below for details about values required for different epoch versions and block types.</p>
<table>
<thead>
<tr>
<th><strong>Device</strong></th>
<th><strong>Epoch v1</strong><br />All Blocks</th>
<th><strong>Epoch v2</strong><br />Send/Change Blocks</th>
<th><strong>Epoch v2</strong><br />Receive Blocks</th>
</tr>
</thead>
<tbody>
<tr>
<td>Nvidia Tesla V100 (AWS)</td>
<td>6.4</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Nvidia Tesla P100 (Google,Cloud)</td>
<td>4.9</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Nvidia Tesla K80 (Google,Cloud)</td>
<td>1.64</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Google Cloud 4 vCores</td>
<td>0.15</td>
<td></td>
<td></td>
</tr>
<tr>
<td>ARM64 server 4 cores (Scaleway)</td>
<td>0.06</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Intel Core i7 6700 @3.7GHz AVX2</td>
<td>0.65</td>
<td>0.07</td>
<td>5.25</td>
</tr>
<tr>
<td>AMD R7-4800U @2.8GHz AVX2</td>
<td>0.64</td>
<td>0.06</td>
<td>3.70</td>
</tr>
<tr>
<td>AMD R5-3600 @4.07GHz</td>
<td>0.59</td>
<td>0.09</td>
<td>3.51</td>
</tr>
<tr>
<td>AMD R9-3900X @3.97GHz AVX2</td>
<td>1.97</td>
<td>0.26</td>
<td>15.6</td>
</tr>
<tr>
<td>Nvidia GTX 1080</td>
<td>2.63</td>
<td>0.37</td>
<td>21.29</td>
</tr>
<tr>
<td>Nvidia RTX 2080 Ti</td>
<td>4.01</td>
<td>0.51</td>
<td>31.5</td>
</tr>
<tr>
<td>AMD R9 290</td>
<td>1.23</td>
<td>0.15</td>
<td>8.06</td>
</tr>
<tr>
<td>AMD RX Vega 64</td>
<td>3.77</td>
<td>0.45</td>
<td>25.00</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="work-calculation-details">Work calculation details<a class="headerlink" href="#work-calculation-details" title="Permanent link">&para;</a></h2>
<h3 id="work-equation">Work equation<a class="headerlink" href="#work-equation" title="Permanent link">&para;</a></h3>
<p>The <code>"work"</code> field in transactions contains a 64-bit <a href="https://en.wikipedia.org/wiki/Cryptographic_nonce">nonce</a> found using the <a href="https://blake2.net/">blake2b hash function</a>.  The nonce satisfies the following equations depending on block height:</p>
<p><strong>Block Height 1</strong></p>
<p>The first block on an account-chain doesn't have a previous (head) block, so the account public key is used (<code>||</code> means concatenation):</p>
<div>
<div class="MathJax_Preview">
blake2b(\text{nonce} || \text{public_key}) \ge \text{threshold}
</div>
<script type="math/tex; mode=display">
blake2b(\text{nonce} || \text{public_key}) \ge \text{threshold}
</script>
</div>
<p><strong>Block Height 2 and up</strong></p>
<p>Once an account has an existing block the previous block hash is used for all blocks going forward:</p>
<div>
<div class="MathJax_Preview">
blake2b(\text{nonce} || \text{prev_block_hash}) \ge \text{threshold}
</div>
<script type="math/tex; mode=display">
blake2b(\text{nonce} || \text{prev_block_hash}) \ge \text{threshold}
</script>
</div>
<h3 id="difficulty-thresholds">Difficulty thresholds<a class="headerlink" href="#difficulty-thresholds" title="Permanent link">&para;</a></h3>
<p>The mainnet's base difficulty threshold is currently <code>ffffffc000000000</code> for all epoch v1 blocks. For a block to be valid, its work field must satisfy the above work equations using this value for threshold. Nodes also prioritize the order in which they confirm transactions based on how far above this threshold the work value is. This only happens in case of saturation.</p>
<p>Due to prioritization, it may be desirable to generate work further above the threshold to guarantee faster processing by the network. To assist integrations with managing these work difficulty levels, nodes monitor the trend of difficulty seen on unconfirmed blocks, and expose that value via the <a href="../../commands/rpc-protocol/#active_difficulty"><code>active_difficulty</code></a> RPC.</p>
<p>After the next <a href="../../releases/network-upgrades/#increased-work-difficulty">network upgrade to increase difficulty</a>, which will occur after the <a href="../../releases/current-release-notes/">V21.0 release</a> and subsequent distribution of epoch v2 blocks, there will be two difficulty thresholds:</p>
<table>
<thead>
<tr>
<th>Epoch version</th>
<th>Block Type</th>
<th>Difficulty Threshold</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>All</td>
<td><code>ffffffc000000000</code></td>
</tr>
<tr>
<td>2</td>
<td>Send or change</td>
<td><code>fffffff800000000</code></td>
</tr>
<tr>
<td>2</td>
<td>Receive</td>
<td><code>fffffe0000000000</code></td>
</tr>
</tbody>
</table>
<p>Although preparations can be done ahead of the upgrade, please find related considerations in the <a href="../../releases/network-upgrades/#increased-work-difficulty">network upgrade to increase difficulty</a> section.</p>
<p><strong>Development node wallet behavior</strong></p>
<p>The developer wallet included with the node is configured to pre-cache work at the base threshold and monitor any blocks it publishes to the network for confirmation. If they are not confirmed within 5 seconds, the difficulty on that block will be compared against the active difficulty seen on the network. If the block has a lower work value than the network, then new work generation is requested at the higher level.</p>
<p><strong>Difficulty management for external integrations</strong></p>
<p>For services aiming to ensure the highest priority on their transactions, the confirmation of published blocks should be monitored by their integration and work levels compared against active difficulty in a similar fashion to the development wallet mentioned above. If work is left at base difficulty there could be delays in the transactions being processed during heavy network usage times.</p>
<div class="admonition tip">
<p class="admonition-title">Configure max work generate multiplier</p>
<p>Due to the possibility of network work levels increasing beyond the capabilities of certain work generation setups, the config option <a href="#nodemax_work_generate_multiplier"><code>node.max_work_generate_multiplier</code></a> can be used to limit how high a work value will be requested at. All setups, whether using the developer wallet or an external integration, should implement an appropriate limit which defaults to 64x in V20.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Upcoming threshold changes and variations by block type</p>
<p>Plans are underway to change the thresholds based on the type of block with the release of V21 and subsequent distribution of v2 epoch blocks to enable the feature. See the <a href="https://medium.com/nanocurrency/development-update-v21-pow-difficulty-increases-362b5d052c8e">Development Update: V21 PoW Difficulty Increases article</a> for full details.</p>
</div>
<h3 id="pre-caching">Pre-caching<a class="headerlink" href="#pre-caching" title="Permanent link">&para;</a></h3>
<p>Work for an account can be pre-cached and saved for immediate use on an account as long as it was based on the current frontier block at the time of use. Although this customization must be made externally to the node, it can help level out potential spikes in work generation, especially useful with wallet implementations.</p>
<p>To accomplish this, after a block is published for an account (whatever type of block), note the <em><strong>hash</strong></em> of that block and use it in a RPC <a href="../../commands/rpc-protocol/#work_generate">work_generate</a> call. Note that you may require setting <code>“use_peers”: “true”</code>.</p>
<p>Upon receiving a response, store its value in your database for later use for that account. Note that after a new block is published for the account, that value will no longer be a valid PoW.</p>
<p><strong>Pre-caching when next block type is unknown</strong></p>
<p>With V21+ the work difficulty thresholds were split by block type. For many integrations, such as wallet providers, the context of what type of block will be generated next for an account is unknown. The recommendation for these cases is to generate difficulty at the higher threshold of a send/change block to ensure delays are avoided and the best user experience is available when using wallets.</p>
<p><strong>Utilizing lower work when batching</strong></p>
<p>For services that process receiving their pending transactions in bulk the lower work threshold of receive blocks can be taken advantage of. In doing so, the difficulty is 64x lower than a send/change block, but the difficulty will be normalized for proper prioritization if published during heavy network load times.</p>
<h3 id="difficulty-multiplier">Difficulty multiplier<a class="headerlink" href="#difficulty-multiplier" title="Permanent link">&para;</a></h3>
<p>Relative difficulty, or difficulty multiplier, describes how much more value a PoW has compared to another. In the node this is typically used to compare against the base threshold, often in relation to rework being performed or validated for proper priotizing of transactions. This value is available as part of the <a href="../../commands/rpc-protocol/#active_difficulty"><code>active_difficulty</code></a> RPC, but can also be obtained with the following expression:</p>
<div>
<div class="MathJax_Preview">
\frac{(2^{64} - \text{base_difficulty})}{(2^{64} - \text{work_difficulty})}
</div>
<script type="math/tex; mode=display">
\frac{(2^{64} - \text{base_difficulty})}{(2^{64} - \text{work_difficulty})}
</script>
</div>
<p>In the inverse direction, in order to get the equivalent difficulty for a certain multiplier, the following expression can be used.</p>
<div>
<div class="MathJax_Preview">
2^{64} - \frac{2^{64} - \text{base_difficulty}}{\text{multiplier}}
</div>
<script type="math/tex; mode=display">
2^{64} - \frac{2^{64} - \text{base_difficulty}}{\text{multiplier}}
</script>
</div>
<details class="example"><summary>Code Snippets</summary><p><strong>Python</strong>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">to_multiplier</span><span class="p">(</span><span class="n">difficulty</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">base_difficulty</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
  <span class="k">return</span> <span class="nb">float</span><span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">64</span><span class="p">)</span> <span class="o">-</span> <span class="n">base_difficulty</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">64</span><span class="p">)</span> <span class="o">-</span> <span class="n">difficulty</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">from_multiplier</span><span class="p">(</span><span class="n">multiplier</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">base_difficulty</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">NANO_DIFFICULTY</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
  <span class="k">return</span> <span class="nb">int</span><span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">64</span><span class="p">)</span> <span class="o">-</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">64</span><span class="p">)</span> <span class="o">-</span> <span class="n">base_difficulty</span><span class="p">)</span> <span class="o">/</span> <span class="n">multiplier</span><span class="p">)</span>
</pre></div></p>
<p><strong>Rust</strong>
<div class="codehilite"><pre><span></span><span class="k">fn</span> <span class="nf">to_multiplier</span><span class="p">(</span><span class="n">difficulty</span>: <span class="kt">u64</span><span class="p">,</span><span class="w"> </span><span class="n">base_difficulty</span>: <span class="kt">u64</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">f64</span> <span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="p">(</span><span class="n">base_difficulty</span><span class="p">.</span><span class="n">wrapping_neg</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">f64</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">difficulty</span><span class="p">.</span><span class="n">wrapping_neg</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">f64</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">from_multiplier</span><span class="p">(</span><span class="n">multiplier</span>: <span class="kt">f64</span><span class="p">,</span><span class="w"> </span><span class="n">base_difficulty</span>: <span class="kt">u64</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">u64</span> <span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="p">(((</span><span class="n">base_difficulty</span><span class="p">.</span><span class="n">wrapping_neg</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">f64</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">multiplier</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">u64</span><span class="p">).</span><span class="n">wrapping_neg</span><span class="p">()</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div></p>
<p><strong>C++</strong>
<div class="codehilite"><pre><span></span><span class="kt">double</span> <span class="nf">to_multiplier</span><span class="p">(</span><span class="kt">uint64_t</span> <span class="k">const</span> <span class="n">difficulty</span><span class="p">,</span> <span class="kt">uint64_t</span> <span class="k">const</span> <span class="n">base_difficulty</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="o">-</span><span class="n">base_difficulty</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="n">difficulty</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">uint64_t</span> <span class="nf">from_multiplier</span><span class="p">(</span><span class="kt">double</span> <span class="k">const</span> <span class="n">multiplier</span><span class="p">,</span> <span class="kt">uint64_t</span> <span class="k">const</span> <span class="n">base_difficulty</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">uint64_t</span><span class="o">&gt;</span><span class="p">((</span><span class="o">-</span><span class="n">base_difficulty</span><span class="p">)</span> <span class="o">/</span> <span class="n">multiplier</span><span class="p">));</span>
<span class="p">}</span>
</pre></div></p>
</details>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        <!-- Application footer -->
<footer class="md-footer">

  <!-- Link to previous and/or next page -->
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">

        <!-- Link to previous page -->
        
          <a href="../block-confirmation-tracking/"
              title="Block Confirmation Tracking"
              class="md-flex md-footer-nav__link md-footer-nav__link--prev"
              rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back
                    md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch
                  md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Block Confirmation Tracking
              </span>
            </div>
          </a>
        

        <!-- Link to next page -->
        
          <a href="../build-options/"
              title="Build Options"
              class="md-flex md-footer-nav__link md-footer-nav__link--next"
              rel="next">
            <div class="md-flex__cell md-flex__cell--stretch
                  md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Build Options
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward
                    md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  

  <!-- Further information -->
    <div class="md-footer-meta md-typeset">
        <div class="md-footer-meta__inner md-grid">
            <div class="md-footer-copyright">
                © Nano Foundation |
                <a href="https://nano.org/terms" target="_blank">
                    Terms of Use
                </a>
                 | 
                <a href="https://nano.org/privacy">
                    Privacy Policy
                </a>
            </div>
            
            <!-- Social links -->
            
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/nanocurrency" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/nano" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://chat.nano.org" class="md-footer-social__link fa fa-comments"></a>
    
      <a href="https://reddit.com/r/nanocurrency" class="md-footer-social__link fa fa-reddit"></a>
    
      <a href="https://medium.com/nanocurrency" class="md-footer-social__link fa fa-medium"></a>
    
      <a href="https://facebook.com/nanofoundation" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://linkedin.com/company/nano-foundation" class="md-footer-social__link fa fa-linkedin"></a>
    
      <a href="https://www.youtube.com/nanocurrency/" class="md-footer-social__link fa fa-youtube"></a>
    
      <a href="https://www.instagram.com/nanocurrency/" class="md-footer-social__link fa fa-instagram"></a>
    
  </div>

        </div>
        <div class="md-footer-meta__inner md-grid md-grid-disclaimer">
    		<div class="md-footer-disclaimer md-footer-copyright">
    			This site uses cookies, see our <a href="https://nano.org/privacy#cookies" target="_blank">Cookie policy</a> for details. The Nano Foundation is not responsible for the content of external sites and services. 
    			<a href="https://nano.org/terms#linked-websites" target="_blank">Learn more</a>
    		</div>
    	</div>
    </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.39abc4af.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="https://unpkg.com/mermaid@8.4.8/dist/mermaid.min.js"></script>
      
        <script src="../../javascript/mermaid-loose-security.js"></script>
      
    
  </body>
</html>