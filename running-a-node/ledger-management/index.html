



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://docs.nano.org/running-a-node/ledger-management/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.2.0">
    
    
      
        <title>Ledger Management - Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.750b69bd.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Noto Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../stylesheets/extras.css">
    
    

<!-- Matomo -->
<script type="text/javascript">
  var _paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://nano.matomo.cloud/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '3']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src='//cdn.matomo.cloud/nano.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->


    
  <!-- Twitter Card data -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@nano">
  <meta name="twitter:title" content="">
  <meta name="twitter:description" content="">
  <meta name="twitter:image" content="https://docs.nano.org/images/nano-docs-open-graph.png" />

  <!-- Open Graph data -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="" />
  <meta property="og:url" content="https://docs.nano.org/running-a-node/ledger-management/" />
  <meta property="og:image" content="https://docs.nano.org/images/nano-docs-open-graph.png" />
  <meta property="og:description" content="" />
  <meta property="og:site_name" content="Nano Docs" />


  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="#4a90e2" data-md-color-accent="#131121">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#ledger-management" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://docs.nano.org/" title="Documentation" class="md-header-nav__button md-logo">
          
            <img src="../../images/nano.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Documentation
            </span>
            <span class="md-header-nav__topic">
              Ledger Management
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/nanocurrency/nano-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    nanocurrency/nano-docs
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://docs.nano.org/" title="Documentation" class="md-nav__button md-logo">
      
        <img src="../../images/nano.svg" width="48" height="48">
      
    </a>
    Documentation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/nanocurrency/nano-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    nanocurrency/nano-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      What is Nano?
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        What is Nano?
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../what-is-nano/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../what-is-nano/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../what-is-nano/exploring-more/" title="Exploring More" class="md-nav__link">
      Exploring More
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Running a Node
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Running a Node
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../security/" title="Security" class="md-nav__link">
      Security
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../node-setup/" title="Node Setup" class="md-nav__link">
      Node Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker-management/" title="Docker Management" class="md-nav__link">
      Docker Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../configuration/" title="Configuration" class="md-nav__link">
      Configuration
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Ledger Management
      </label>
    
    <a href="./" title="Ledger Management" class="md-nav__link md-nav__link--active">
      Ledger Management
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ledger-file" title="Ledger file" class="md-nav__link">
    Ledger file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" title="Configuration" class="md-nav__link">
    Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bootstrapping" title="Bootstrapping" class="md-nav__link">
    Bootstrapping
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tuning-options" title="Tuning options" class="md-nav__link">
    Tuning options
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#downloaded-ledger-files" title="Downloaded ledger files" class="md-nav__link">
    Downloaded ledger files
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-source" title="Data source" class="md-nav__link">
    Data source
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validating-blocks-and-voting-weights" title="Validating blocks and voting weights" class="md-nav__link">
    Validating blocks and voting weights
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#confirmation-data" title="Confirmation data" class="md-nav__link">
    Confirmation data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-the-node" title="Updating the node" class="md-nav__link">
    Updating the node
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rocksdb-ledger-backend" title="RocksDB Ledger Backend" class="md-nav__link">
    RocksDB Ledger Backend
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installation" title="Installation" class="md-nav__link">
    Installation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-node-with-rocksdb-support" title="Build node with RocksDB support" class="md-nav__link">
    Build node with RocksDB support
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enable-rocksdb" title="Enable RocksDB" class="md-nav__link">
    Enable RocksDB
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../voting-as-a-representative/" title="Voting as a Representative" class="md-nav__link">
      Voting as a Representative
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../beta-network/" title="Beta Network" class="md-nav__link">
      Beta Network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../beyond-the-node/" title="Beyond the Node" class="md-nav__link">
      Beyond the Node
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Integration Guides
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Integration Guides
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../integration-guides/the-basics/" title="The Basics" class="md-nav__link">
      The Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integration-guides/key-management/" title="Key Management" class="md-nav__link">
      Key Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integration-guides/block-confirmation-tracking/" title="Block Confirmation Tracking" class="md-nav__link">
      Block Confirmation Tracking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integration-guides/work-generation/" title="Work Generation" class="md-nav__link">
      Work Generation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integration-guides/build-options/" title="Build Options" class="md-nav__link">
      Build Options
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integration-guides/websockets/" title="WebSockets" class="md-nav__link">
      WebSockets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integration-guides/ipc-integration/" title="IPC Integration" class="md-nav__link">
      IPC Integration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integration-guides/advanced/" title="Advanced" class="md-nav__link">
      Advanced
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Commands
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Commands
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../commands/rpc-protocol/" title="RPC Protocol" class="md-nav__link">
      RPC Protocol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../commands/command-line-interface/" title="Command Line Interface" class="md-nav__link">
      Command Line Interface
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Protocol Design
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Protocol Design
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../protocol-design/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../protocol-design/distribution-and-units/" title="Distribution and Units" class="md-nav__link">
      Distribution and Units
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../protocol-design/networking/" title="Networking" class="md-nav__link">
      Networking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../protocol-design/network-attacks/" title="Network Attacks" class="md-nav__link">
      Network Attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../protocol-design/signing-hashing-and-key-derivation/" title="Signing, Hashing and Key Derivation" class="md-nav__link">
      Signing, Hashing and Key Derivation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../whitepaper/english/" title="Original whitepaper" class="md-nav__link">
      Original whitepaper
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Releases
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Releases
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../releases/node-releases/" title="Node Releases" class="md-nav__link">
      Node Releases
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../releases/network-upgrades/" title="Network Upgrades" class="md-nav__link">
      Network Upgrades
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../releases/upcoming-features/" title="Upcoming Features" class="md-nav__link">
      Upcoming Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../releases/roadmap/" title="Roadmap" class="md-nav__link">
      Roadmap
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../glossary/" title="Glossary" class="md-nav__link">
      Glossary
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ledger-file" title="Ledger file" class="md-nav__link">
    Ledger file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" title="Configuration" class="md-nav__link">
    Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bootstrapping" title="Bootstrapping" class="md-nav__link">
    Bootstrapping
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tuning-options" title="Tuning options" class="md-nav__link">
    Tuning options
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#downloaded-ledger-files" title="Downloaded ledger files" class="md-nav__link">
    Downloaded ledger files
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-source" title="Data source" class="md-nav__link">
    Data source
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validating-blocks-and-voting-weights" title="Validating blocks and voting weights" class="md-nav__link">
    Validating blocks and voting weights
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#confirmation-data" title="Confirmation data" class="md-nav__link">
    Confirmation data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-the-node" title="Updating the node" class="md-nav__link">
    Updating the node
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rocksdb-ledger-backend" title="RocksDB Ledger Backend" class="md-nav__link">
    RocksDB Ledger Backend
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installation" title="Installation" class="md-nav__link">
    Installation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-node-with-rocksdb-support" title="Build node with RocksDB support" class="md-nav__link">
    Build node with RocksDB support
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enable-rocksdb" title="Enable RocksDB" class="md-nav__link">
    Enable RocksDB
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/nanocurrency/nano-docs/edit/master/docs/running-a-node/ledger-management.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="ledger-management">Ledger Management<a class="headerlink" href="#ledger-management" title="Permanent link">&para;</a></h1>
<div class="admonition tip">
<p class="admonition-title">Default and experimental backends available</p>
<p>By default the node uses LMDB as the ledger backend, which the first part of this guide is focused on. The second part of the guide covers <a href="#rocksdb-ledger-backend">RocksDB</a>, which is an experimental option available as of <em>v20.0+</em>.</p>
</div>
<h2 id="ledger-file">Ledger file<a class="headerlink" href="#ledger-file" title="Permanent link">&para;</a></h2>
<p>The node automatically manages the full Nano ledger in the <code>data.ldb</code> file which can be found in the data folder at these locations:</p>
<table>
<thead>
<tr>
<th><strong>OS</strong></th>
<th><strong>Location</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows</td>
<td><code class="codehilite">C:<span class="se">\U</span>sers<span class="se">\&lt;</span>user&gt;<span class="se">\A</span>ppData<span class="se">\L</span>ocal<span class="se">\N</span>ano<span class="se">\</span></code></td>
</tr>
<tr>
<td>macOS</td>
<td><code class="codehilite">/Users/&lt;user&gt;/Library/Nano/</code></td>
</tr>
<tr>
<td>Linux</td>
<td><code class="codehilite">/home/&lt;user&gt;/Nano/</code></td>
</tr>
</tbody>
</table>
<p>This file will grow in size as the ledger does. As of April 2020 there are over 49 million blocks in the ledger which requires at least 26GB of free space. See <a href="/running-a-node/node-setup/#hardware-recommendations">hardware recommendations</a> for more preferred node specs.</p>
<div class="admonition warning">
<p class="admonition-title">RocksDB uses many files</p>
<p>The above details are for the default LMDB database setup. If using RocksDB, please note that it uses potentially 100s of SST files to manage the ledger so details should be followed from the <a href="#rocksdb-ledger-backend">RocksDB Ledger Backend</a> section below.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Updating the node may require a lengthy ledger upgrade</p>
<p>Read the <a href="#updating-the-node">guide</a> further down this page for some tips on how to minimize downtime during an update.</p>
</div>
<hr />
<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">&para;</a></h2>
<div class="admonition note">
<p>Available in Version 21.0+ only</p>
</div>
<p>Within the <code>node.lmdb</code> section of the <a href="../configuration/#configuration-file-locations"><code>config-node.toml</code></a> file, the following options can be set to better tune LMDB performance for the available resources.</p>
<table>
<thead>
<tr>
<th>Option name</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>map_size</code></td>
<td>Allows the map size to be changed (default value is 128GB). This only affects the ledger database.</td>
</tr>
<tr>
<td><code>max_databases</code></td>
<td>Maximum open LMDB databases. Increase default if more than 100 wallets is required. <a href="/integration-guides/key-management/">External management</a> is recommended when a large amounts of wallets are required.</td>
</tr>
<tr>
<td><code>sync</code></td>
<td>LMDB environment flags. Applies to ledger, not wallet:<ul><li><code>always</code>: Default (MDB_NOSUBDIR | MDB_NOTLS | MDB_NORDAHEAD).</li><li><code>nosync_safe</code>: Do not flush meta data eagerly. This may cause loss of transactions, but maintains integrity (MDB_NOSUBDIR | MDB_NOTLS | MDB_NORDAHEAD | MDB_NOMETASYNC).</li><li><code>nosync_unsafe</code>: Let the OS decide when to flush to disk. On filesystems with write ordering, this has the same guarantees as nosync_safe, otherwise corruption may occur on system crash (MDB_NOSUBDIR | MDB_NOTLS | MDB_NORDAHEAD | MDB_NOSYNC).</li><li><code>nosync_unsafe_large_memory</code>: Use a writeable memory map. Let the OS decide when to flush to disk, and make the request asynchronous. This may give better performance on systems where the database fits entirely in memory, otherwise it may be slower. Note that this option will expand the file size logically to map_size. It may expand the file physically on some file systems. (MDB_NOSUBDIR | MDB_NOTLS | MDB_NORDAHEAD | MDB_NOSYNC | MDB_WRITEMAP | MDB_MAPASYNC).</li></ul></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="bootstrapping">Bootstrapping<a class="headerlink" href="#bootstrapping" title="Permanent link">&para;</a></h2>
<p>When starting a new node the ledger must be downloaded and kept updated in order to participate on the network properly. This is done automatically via bootstrapping - the node downloads and verifies blocks from other nodes across the network. This process can take hours to days to complete depending on network conditions and <a href="/running-a-node/node-setup/#hardware-recommendations">hardware specifications</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Restarting node during bootstrapping not recommended</p>
<p>It is <strong>highly recommended to avoid restarting the node during bootstrapping</strong> as this can cause extra delays in the syncing process. An exception can be made when it is very clear from calls to the <a href="/commands/rpc-protocol/#block_count"><code>block_count</code></a> RPC that block counts are stuck for multiple hours.</p>
</div>
<h3 id="tuning-options">Tuning options<a class="headerlink" href="#tuning-options" title="Permanent link">&para;</a></h3>
<p>Depending on machine and networking resources, the bootstrap performance can be improved by updating the following <a href="/running-a-node/configuration/">configuration</a> values in the <a href="../configuration/#configuration-file-locations"><code>config-node.toml</code></a> file:</p>
<ul>
<li><code>node.bootstrap_connections_max</code>: up to max of <code>128</code></li>
<li><code>node.bootstrap_connections</code>: up to max of <code>16</code></li>
</ul>
<p>The additional resource usage these options cause should be considered, especially if left during normal operation (after initial bootstrap is complete).</p>
<hr />
<h2 id="downloaded-ledger-files">Downloaded ledger files<a class="headerlink" href="#downloaded-ledger-files" title="Permanent link">&para;</a></h2>
<div class="admonition tip">
<p class="admonition-title">Always backup your ledgers file</p>
<p>Whenever you are attempting to change the ledger, it is highly recommended you create backups of the existing <code>data.ldb</code> file to ensure you have a rollback point if issues are encountered.</p>
</div>
<p>To avoid bootstrapping times, a <a href="#ledger-file">ledger file</a> (<code>data.ldb</code>) can be downloaded off-network and added to the data file used by the node. This process is sometimes referred to as a "fast sync". The Nano Foundation provides a daily ledger file download in the <code>#ledger</code> channel of our <a href="https://chat.nano.org">Discord server</a>. This is posted by <code>SergSW</code> and contains checksums for validation.
Alternatively, one of <a href="https://mynano.ninja/api">My Nano Ninja</a> APIs redirects the current ledger file preserved at <a href="https://yandex.com/">Yandex</a>:
<div class="codehilite"><pre><span></span>wget -O ledger.7z https://mynano.ninja/api/ledger/download -q --show-progress
</pre></div></p>
<p>Verify the checksum of the above downloaded ledger file:
<div class="codehilite"><pre><span></span><span class="nb">printf</span> <span class="s2">&quot;%s ledger.7z&quot;</span> <span class="sb">`</span>wget -q -O - https://mynano.ninja/api/ledger/checksum/sha256<span class="sb">`</span> <span class="p">|</span> sha256sum --check
</pre></div></p>
<p>Be patient and wait for the message <code>ledger.7z: OK</code>.</p>
<p>Before using this method there are a few considerations to ensure it is done safely:</p>
<h3 id="data-source">Data source<a class="headerlink" href="#data-source" title="Permanent link">&para;</a></h3>
<p>Make sure you trust the source providing the data to you. If you are unfamiliar with the individual or organization providing the ledger, consider other options for the data or fallback to the default of <a href="#bootstrapping">bootstrapping</a> from the network.</p>
<h3 id="validating-blocks-and-voting-weights">Validating blocks and voting weights<a class="headerlink" href="#validating-blocks-and-voting-weights" title="Permanent link">&para;</a></h3>
<p>Blocks are confirmed using the voting weight of representatives and these weights are determined by the account balances assigned to those representatives. In addition, the node releases contain a hard-coded set of representative weights captured at the time of the node release to help this process during bootstrapping.</p>
<p>If looking to use a downloaded ledger there is a risk of it providing inaccurate representative voting weights. Although the potential impacts of this are minimal, below are some recommended steps to take which can help provide additional confidence the ledger can be used.</p>
<ol>
<li><strong>Scan the ledger for integrity using the <a href="/commands/command-line-interface/#-debug_validate_blocks"><code>--debug_validate_blocks</code></a> CLI command</strong>. If issues are found they should be inspected carefully and alternative sources of a ledger may need to be considered as failures with this command have a high chance of indicating potentially malicious behavior.</li>
<li><strong>Review the differences in representative voting weights by running the <a href="/commands/command-line-interface/#-compare_rep_weights"><code>--compare_rep_weights</code></a> CLI command</strong> (<em>v21.0+ only)</em> with the new ledger in the default data folder (old ledger backed up) or in a different data folder by using the optional <code>--data_path</code> argument. This will compare the new ledger voting weights against the hardcoded values in the node (set at the time of release). See the <a href="/commands/command-line-interface/#-compare_rep_weights">CLI command</a> for details on the output with special attention paid to entries in the <code>outliers</code> and <code>newcomers</code> sections. By inspecting those addresses in public explorers such as <a href="https://nanocrawler.cc">Nanocrawler.cc</a>, this can help to determine if voting weight may have been manipulated in the downloaded ledger.</li>
</ol>
<p>If you need support with this process or need help in evaluating some of the CLI command results, join the <a href="https://forum.nano.org/c/node-and-rep/8">Node and Representative Management category</a> on the <a href="https://forum.nano.org">Nano Forums</a>.</p>
<h3 id="confirmation-data">Confirmation data<a class="headerlink" href="#confirmation-data" title="Permanent link">&para;</a></h3>
<p>Within each account on the ledger a confirmation height is set. This indicates the height of the last block on that chain where quorum was observed on the network. This is set locally by the node and a new ledger file may include this information with it. If the ledger is from a trusted source this confirmation data can be kept, which will save bandwidth and resources on the network by not querying for votes to verify these confirmations.</p>
<p>If confirmation data for the ledger is not trusted the <a href="/commands/command-line-interface/#-confirmation_height_clear">--confirmation_height_clear</a> CLI can be used to clear these out.</p>
<hr />
<h2 id="updating-the-node">Updating the node<a class="headerlink" href="#updating-the-node" title="Permanent link">&para;</a></h2>
<p>Occasionally, updating to the <a href="/releases/node-releases/#current-release">latest node version</a> requires upgrading the existing ledger which can have the following effects:</p>
<ul>
<li>Significant downtime, from a few minutes to several hours, during which the node RPC is not accessible and no voting occurs. The upgrade is especially slower if the ledger is not on an SSD.</li>
<li>Temporary increased disk space usage - up to 3x the current ledger size in total (e.g. 60GB for a 20GB ledger)</li>
</ul>
<p>In order to minimize downtime, consider performing the update in a different machine, and replacing the <a href="#ledger-file">ledger file</a> once complete. Note the following instructions, where <strong>Machine A</strong> has the node and ledger, and <strong>Machine B</strong> will be updating it.</p>
<ol>
<li>Create a directory <code>/home/&lt;user&gt;/Nano_Update</code> on Machine B.</li>
<li>Stop the node on Machine A.</li>
<li>Copy the <code>data.ldb</code> <a href="#ledger-management">file</a> from Machine A to <code>/home/&lt;user&gt;/Nano_Update/data.ldb</code> on Machine B.</li>
<li>Start the node again on Machine A.</li>
<li>Download the <a href="/releases/node-releases/#current-release">latest node version</a>. For the purposes of this guide, using a binary is easier.</li>
<li>Run the following command (varies based on your operating system): <code>./nano_node --debug_block_count --data_path /home/&lt;user&gt;/Nano_Update --config node.logging.log_to_cerr=true</code></li>
<li>The message <em>"Upgrade in progress..."</em> will be displayed if a ledger upgrade is required. Wait until the command finishes and <strong>do not stop the upgrade preemptively</strong>.</li>
<li>Copy <code>/home/&lt;user&gt;/Nano_Update/data.ldb</code> from Machine B to a temporary location on Machine A. <strong>do not overwrite data.ldb on Machine A while the node is running</strong>.</li>
<li>Stop and <strong>upgrade</strong> to the latest node version on Machine A as you would do normally.</li>
<li>Stop the node on Machine A in case upgrading restarted it.</li>
<li>Replace <code>/home/&lt;user&gt;/Nano/data.ldb</code> with the transferred file.</li>
<li>Restart the node.</li>
</ol>
<p>In the event that you are unable to upgrade the ledger on another machine but would still like to minimize downtime, consider <a href="#downloaded-ledger-files">obtaining the ledger from another source</a> as a last resource.</p>
<hr />
<h2 id="rocksdb-ledger-backend">RocksDB Ledger Backend<a class="headerlink" href="#rocksdb-ledger-backend" title="Permanent link">&para;</a></h2>
<div class="admonition warning">
<p class="admonition-title">RocksDB is experimental, do not use in production</p>
<p>RocksDB is being included in <em>V20.0</em> as experimental only. Future versions of the node may allow for production use of RocksDB, however old experimental RocksDB ledgers are not guarenteed to be compatible and may require resyncing from scratch.</p>
<p>If you are testing RocksDB and want to discuss results, configurations, etc. please join the forum topic here: <a href="https://forum.nano.org/t/rocksdb-ledger-backend-testing/111">https://forum.nano.org/t/rocksdb-ledger-backend-testing/111</a></p>
</div>
<p>The node ledger currently uses LMDB (Lightning memory-mapped database) by default as the data store. As of <em>v20+</em> the option to use RocksDB becomes available as an experimental option.
This document will not go into much detail about theses key-value data stores as there is a lot of information available online.
It is anticipated that bootstrapping will be slower using RocksDB during the initial version at least, but live traffic should be faster due to singluar writes being cached in memory and flushed to disk in bulk.</p>
<p>Using RocksDB requires a few extra steps as it is an externally required dependency which requires a recent version of RocksDB, so older repositories may not be sufficient, it also requires <code>zlib</code>. If using the docker node, skip to <a href="#enable-rocksdb">Enable RocksDB</a>.</p>
<h3 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h3>
<p><strong>Linux</strong><br />
Ubuntu 19.04 and later:
<div class="codehilite"><pre><span></span>sudo apt-get install zlib1g-dev
sudo apt-get install librocksdb-dev
</pre></div>
Otherwise:
<div class="codehilite"><pre><span></span>sudo apt-get install zlib1g-dev
export USE_RTTI=1
git clone https://github.com/facebook/rocksdb.git
cd rocksdb
make static_lib
make install
</pre></div>
<strong>MacOS</strong><br />
<code>brew install rocksdb</code></p>
<p><strong>Windows</strong><br />
Recommended way is to use <code>vcpkg</code>:</p>
<ul>
<li>add <code>set (VCPKG_LIBRARY_LINKAGE static)</code> to the top of <code>%VCPKG_DIR%\ports\rocksdb\portfile.cmake</code></li>
<li><code>vcpkg install rocksdb:x64-windows</code></li>
</ul>
<p>For other or more detailed instructions visit the official page:
<a href="https://github.com/facebook/rocksdb/blob/master/INSTALL.md">https://github.com/facebook/rocksdb/blob/master/INSTALL.md</a></p>
<h3 id="build-node-with-rocksdb-support">Build node with RocksDB support<a class="headerlink" href="#build-node-with-rocksdb-support" title="Permanent link">&para;</a></h3>
<p>Once RocksDB is installed successfully, the node must be built with RocksDB support using the CMake variable <code>-DNANO_ROCKSDB=ON</code></p>
<p>The following CMake options can be used to specify where the RocksDB and zlib libraries are if they cannot be found automatically:
<div class="codehilite"><pre><span></span>ROCKSDB_INCLUDE_DIRS
ROCKSDB_LIBRARIES
ZLIB_LIBRARY
ZLIB_INCLUDE_DIR
</pre></div></p>
<h3 id="enable-rocksdb">Enable RocksDB<a class="headerlink" href="#enable-rocksdb" title="Permanent link">&para;</a></h3>
<p>This can be enabled by adding the following to the <code>config-node.toml</code> file:</p>
<div class="codehilite"><pre><span></span>[node.rocksdb]
enable = true
</pre></div>

<p>There are many other options which can be set. Due to RocksDB generally using more memory the defaults have been made pessimistic in order to run on a wider range of lower end devices. Recommended settings if on a system with 8GB or more RAM (see TOML comments in the generated file for more information on what these do):</p>
<p><div class="codehilite"><pre><span></span>[node.rocksdb]
bloom_filter_bits = 10
block_cache = 1024
enable_pipelined_write=true
cache_index_and_filter_blocks=true
block_size=64
memtable_size=128
num_memtables=3
total_memtable_size=0
</pre></div>
Comparision:</p>
<table>
<thead>
<tr>
<th align="center">LMDB</th>
<th align="center">RocksDB</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Tested with the node for many years</td>
<td align="center">Experimental status</td>
</tr>
<tr>
<td align="center">1 file (data.ldb)</td>
<td align="center">100+ SST files</td>
</tr>
<tr>
<td align="center">*15GB live ledger size</td>
<td align="center">Smaller file size (11GB)</td>
</tr>
<tr>
<td align="center">Not many options to configure</td>
<td align="center">Very configurable</td>
</tr>
<tr>
<td align="center">Unlikely to be further optimized</td>
<td align="center">Many optimizations possible in future</td>
</tr>
<tr>
<td align="center">Part of the node build process</td>
<td align="center">Required external dep (incl recent version 5.13+)</td>
</tr>
<tr>
<td align="center">-</td>
<td align="center">Less file I/O (writes are flushed in bulk)</td>
</tr>
<tr>
<td align="center">-</td>
<td align="center">May use more memory</td>
</tr>
</tbody>
</table>
<p>* At the time of writing (Oct 2019)</p>
<p>RocksDB Limitations:</p>
<ul>
<li>Automatic backups not currently supported</li>
<li>Database transaction tracker is not supported</li>
<li>Cannot execute CLI commands which require writing to the database, such as <code>nano_node --peer_clear</code> these must be executed when the node is stopped</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Snapshotting with RocksDB</p>
<p>When backing up using the --snapshot CLI option, it is currently set up to do incremental backups, which reduces the need to copy the whole database. However if the original files are deleted, then the backup directory should also be deleted otherwise there can be inconsistencies.</p>
</div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        <!-- Application footer -->
<footer class="md-footer">

  <!-- Link to previous and/or next page -->
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">

        <!-- Link to previous page -->
        
          <a href="../configuration/"
              title="Configuration"
              class="md-flex md-footer-nav__link md-footer-nav__link--prev"
              rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back
                    md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch
                  md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Configuration
              </span>
            </div>
          </a>
        

        <!-- Link to next page -->
        
          <a href="../voting-as-a-representative/"
              title="Voting as a Representative"
              class="md-flex md-footer-nav__link md-footer-nav__link--next"
              rel="next">
            <div class="md-flex__cell md-flex__cell--stretch
                  md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Voting as a Representative
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward
                    md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  

  <!-- Further information -->
    <div class="md-footer-meta md-typeset">
        <div class="md-footer-meta__inner md-grid">
            <div class="md-footer-copyright">
                © Nano Foundation |
                <a href="https://nano.org/terms" target="_blank">
                    Terms of Use
                </a>
                 | 
                <a href="https://nano.org/privacy">
                    Privacy Policy
                </a>
            </div>
            
            <!-- Social links -->
            
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/nanocurrency" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/nano" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://chat.nano.org" class="md-footer-social__link fa fa-comments"></a>
    
      <a href="https://reddit.com/r/nanocurrency" class="md-footer-social__link fa fa-reddit"></a>
    
      <a href="https://medium.com/nanocurrency" class="md-footer-social__link fa fa-medium"></a>
    
      <a href="https://facebook.com/nanofoundation" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://linkedin.com/company/nano-foundation" class="md-footer-social__link fa fa-linkedin"></a>
    
      <a href="https://www.youtube.com/nanocurrency/" class="md-footer-social__link fa fa-youtube"></a>
    
      <a href="https://www.instagram.com/nanocurrency/" class="md-footer-social__link fa fa-instagram"></a>
    
  </div>

        </div>
        <div class="md-footer-meta__inner md-grid md-grid-disclaimer">
    		<div class="md-footer-disclaimer md-footer-copyright">
    			This site uses cookies, see our <a href="https://nano.org/privacy#cookies" target="_blank">Cookie policy</a> for details. The Nano Foundation is not responsible for the content of external sites and services. 
    			<a href="https://nano.org/terms#linked-websites" target="_blank">Learn more</a>
    		</div>
    	</div>
    </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.39abc4af.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="https://unpkg.com/mermaid@8.4.8/dist/mermaid.min.js"></script>
      
        <script src="../../javascript/mermaid-loose-security.js"></script>
      
    
  </body>
</html>